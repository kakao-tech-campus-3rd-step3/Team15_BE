<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>관리자 대시보드 - 사용자 관리</title>
</head>
<body>
<header>
    <h1>관리자 페이지</h1>
    <p>여기에 사용자 목록이 표시됩니다.</p>
</header>

<!-- 리다이렉트 메시지 표시 (RedirectAttributes → ?msg=...) -->
<div th:if="${param.msg}">
    <div style="margin:8px 0; padding:8px; border:1px solid #cce;"
         th:text="${param.msg[0]}">메시지</div>
</div>

<section>
    <table border="1" cellpadding="6" cellspacing="0">
        <thead>
        <tr>
            <th>ID</th>
            <th>이메일</th>
            <th>권한</th>
            <th>상태</th>
            <th>액션</th>
        </tr>
        </thead>
        <tbody>
        <!-- 사용자 목록 렌더링 -->
        <tr th:each="u : ${users}">
            <td th:text="${u.id}">1</td>
            <td th:text="${u.email}">user@example.com</td>
            <td th:text="${u.role}">USER</td>
            <td th:text="${u.status}">ACTIVE</td>
            <td>
                <!-- ACTIVE → 차단 버튼 -->
                <form th:if="${u.status.name() == 'ACTIVE'}"
                      th:action="@{'/admin/users/' + ${u.id} + '/block'}"
                      method="post" style="display:inline;">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                    <button type="submit">차단</button>
                </form>

                <!-- BLOCKED → 해제 버튼 -->
                <form th:if="${u.status.name() == 'BLOCKED'}"
                      th:action="@{'/admin/users/' + ${u.id} + '/unblock'}"
                      method="post" style="display:inline;">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                    <button type="submit">해제</button>
                </form>
            </td>
        </tr>

        <!-- 목록이 비었을 때 -->
        <tr th:if="${#lists.isEmpty(users)}">
            <td colspan="5">사용자가 없습니다.</td>
        </tr>
        </tbody>
    </table>
</section>
</body>
</html>
