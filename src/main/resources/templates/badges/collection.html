<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>내 배지 컬렉션</title>
    <style>
        .stats { display:flex; gap:20px; margin-bottom:16px; }
        .stat  { padding:16px 20px; border-radius:12px; background:#f6f7fb; }
        .tabs { display:flex; gap:16px; margin:12px 0; }
        .tab  { padding:8px 12px; border-radius:20px; background:#eee; cursor:pointer; }
        .tab.active { background:#222; color:#fff; }
        .grid { display:grid; grid-template-columns:repeat(3,1fr); gap:16px; }
        .card { border:1px solid #e5e7eb; border-radius:16px; padding:16px; background:#fff; }
        .badge-name { font-weight:700; }
        .muted { color:#6b7280; font-size:12px;}
        .progress { height:8px; background:#eee; border-radius:999px; margin-top:8px; }
        .bar { height:8px; border-radius:999px; background:#6366f1; }
        .pill { font-size:11px; padding:3px 8px; border-radius:999px; background:#eef2ff; color:#3730a3; margin-left:8px;}
    </style>
    <script>
        function switchTab(tab) {
            document.querySelectorAll("[data-tab]").forEach(e => e.classList.remove("active"));
            document.querySelectorAll("[data-panel]").forEach(e => e.style.display="none");
            document.querySelector(`[data-tab='${tab}']`).classList.add("active");
            document.querySelector(`[data-panel='${tab}']`).style.display="block";
        }
        document.addEventListener("DOMContentLoaded", ()=> switchTab('earned'));
    </script>
</head>
<body>
<h2>내 배지 컬렉션</h2>

<div class="stats">
    <div class="stat">획득한 배지<br><b th:text="${vm.earnedCount}"></b></div>
    <div class="stat">진행 중 배지<br><b th:text="${vm.inProgressCount}"></b></div>
    <div class="stat">잠긴 배지<br><b th:text="${vm.lockedCount}"></b></div>
    <div class="stat">전체 배지<br><b th:text="${vm.totalCount}"></b></div>
</div>

<div class="tabs">
    <div class="tab active" data-tab="earned" onclick="switchTab('earned')">획득한 배지</div>
    <div class="tab" data-tab="inprogress" onclick="switchTab('inprogress')">진행 중</div>
    <div class="tab" data-tab="locked" onclick="switchTab('locked')">잠긴 배지</div>
    <div class="tab" data-tab="all" onclick="switchTab('all')">전체 배지</div>
</div>

<!-- 패널: 획득 -->
<div data-panel="earned">
    <div class="grid">
        <div class="card" th:each="b : ${vm.earned}">
            <div class="badge-name" th:text="${b.name}"></div>
            <div class="muted">
                <span th:text="${b.kind}"></span>
                <span class="pill" th:text="${b.tier}"></span>
            </div>
            <div class="muted">획득일:
                <span th:text="${#temporals.format(b.earnedAt, 'yyyy.MM.dd HH:mm')}"></span>
            </div>
        </div>
    </div>
</div>

<!-- 패널: 진행 중 -->
<div data-panel="inprogress" style="display:none;">
    <div class="grid">
        <div class="card" th:each="b : ${vm.inProgress}">
            <div class="badge-name" th:text="${b.name}"></div>
            <div class="muted">
                <span th:text="${b.kind}"></span>
                <span class="pill" th:text="${b.tier}"></span>
            </div>
            <div class="muted">
                진행도: <b th:text="${b.current}"></b>/<span th:text="${b.threshold}"></span>
            </div>
            <div class="progress"><div class="bar" th:style="'width:' + ${b.percent} + '%;'"></div></div>
        </div>
    </div>
</div>

<!-- 패널: 잠김 -->
<div data-panel="locked" style="display:none;">
    <div class="grid">
        <div class="card" th:each="b : ${vm.locked}">
            <div class="badge-name" th:text="${b.name}"></div>
            <div class="muted"><span th:text="${b.kind}"></span><span class="pill" th:text="${b.tier}"></span></div>
            <div class="muted">달성 조건: <span th:text="${b.threshold}"></span></div>
            <div class="progress"><div class="bar" style="width:0%"></div></div>
        </div>
    </div>
</div>

<!-- 패널: 전체 -->
<div data-panel="all" style="display:none;">
    <div class="grid">
        <div class="card" th:each="b : ${vm.all}">
            <div class="badge-name" th:text="${b.name}"></div>
            <div class="muted">
                <span th:text="${b.kind}"></span>
                <span class="pill" th:text="${b.tier}"></span>
                <span th:if="${b.earned}" class="pill" style="background:#dcfce7;color:#065f46;">획득</span>
                <span th:if="${!b.earned && b.current>0}" class="pill" style="background:#fef9c3;color:#854d0e;">진행중</span>
                <span th:if="${!b.earned && b.current==0}" class="pill" style="background:#e5e7eb;color:#374151;">잠김</span>
            </div>
            <div class="muted" th:if="${b.earned}">
                획득일: <span th:text="${#temporals.format(b.earnedAt, 'yyyy.MM.dd HH:mm')}"></span>
            </div>
            <div class="muted" th:unless="${b.earned}">
                진행도: <b th:text="${b.current}"></b>/<span th:text="${b.threshold}"></span>
            </div>
            <div class="progress"><div class="bar" th:style="'width:' + ${b.percent} + '%;'"></div></div>
        </div>
    </div>
</div>
</body>
</html>
